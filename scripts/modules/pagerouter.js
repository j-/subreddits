define(["require","crossroads","querystring","ok","underscore","jquery"],function(e){var t=e("crossroads"),n=e("querystring"),r=e("ok"),i=e("underscore"),s=e("jquery"),o=r.Controller,u="(new|rising|controversial|top|gilded|ads)",a="(?:\\/"+u+")?",f="(?:\\?(.*?))?$",l="\\/?",c="(\\w+(?:\\+\\w+)*)",h="(?:\\/\\w+)?",p=function(e,t){return new RegExp(e,t)},d=function(e){return String(e).replace(/\//g,"\\/")},v=p("^$|^"+a+l+f,"i"),m=p(d("^/r/")+c+a+l+f,"i"),g=p(d("^/u(?:ser)?/([\\w-]+)")+l+f,"i"),y=p(d("^/u(?:ser)?/([\\w-]+)/m/([\\w-]+)")+l+f,"i"),b=p(d("^/domain?/([\\w-]+(?:\\.[\\w-]+)+)")+l+a+f,"i"),w=p(d("^/(?:r/"+c+"/)?comments/(\\w+)")+h+l+f,"i"),E=p(d("^/search")+l+f,"i"),S=p(d("^/submit")+l+f,"i"),x=p("^(.*)$"),T=o.extend({init:function(){i.bindAll(this,"parseCurrent","hitFrontPage","hitSubreddit","hitUserpage","hitDomain","hitSearch","hitSubmit","hitMulti","hitSubredditComments","hit404"),t.addRoute(v,this.hitFrontPage),t.addRoute(m,this.hitSubreddit),t.addRoute(g,this.hitUserpage),t.addRoute(y,this.hitMulti),t.addRoute(b,this.hitDomain),t.addRoute(w,this.hitSubredditComments),t.addRoute(E,this.hitSearch),t.addRoute(S,this.hitSubmit),t.addRoute(x,this.hit404)},hitFrontPage:function(e,t){this.trigger("route:frontpage",e,n.parse(t))},hitSubreddit:function(e,t,r){this.trigger("route:subreddit",e,t,n.parse(r))},hitUserpage:function(e,t){this.trigger("route:username",e,n.parse(t))},hitMulti:function(e,t,r,i){this.trigger("route:multi",e,t,r,n.parse(i))},hitDomain:function(e,t,r){this.trigger("route:domain",e,t,n.parse(r))},hitSubredditComments:function(e,t,r){this.trigger("route:comments",t,n.parse(r))},hitSearch:function(e){this.trigger("route:search",n.parse(e))},hitSubmit:function(e){this.trigger("route:submit",n.parse(e))},hit404:function(e){console.warn("Could not match route",e),this.trigger("route:404",e)},go:function(e){location.hash=e},parseCurrent:function(){var e=location.hash,n=e.substring(1);t.parse(n)},start:function(){s(window).on("hashchange",this.parseCurrent)},stop:function(){o.prototype.stop.call(this),s(window).off("hashchange",this.parseCurrent)}});return new T});