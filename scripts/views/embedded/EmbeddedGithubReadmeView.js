define(["require","views/embedded/EmbeddedView","jquery","marked"],function(e){var t=e("views/embedded/EmbeddedView"),n=e("jquery"),r=e("marked"),i=t.extend({className:"embedded-content embedded-githubreadme",init:function(){this.canFetch=!0},render:function(){this.ensureContent()},ensureContent:function(){if(!this.canFetch)return;this.showLoading(),this.canFetch=!1;var e=this.watch.get("url"),t=e.match(i.githubProjectExp),r=t[1],s=t[2],e=i.getProjectURL(r,s);n.ajax({url:e,context:this,success:function(e){var t=e.content,n=atob(t);this.renderContent(n)},error:function(e,t,n){this.showError(),this.canFetch=!0}})},renderContent:function(e){var t=r(e);this.$el.html(t)},showLoading:function(){var e=n.create("span").addClass("text-muted").text("Loadingâ€¦");this.empty(),this.$el.append(e)},showError:function(){this.$el.text("There was an error loading this readme")}});return i.githubProjectExp=/github.com\/(.*?)\/(.*?)(?:\/|$)/i,i.identify=function(e){var t=e.get("url");return i.githubProjectExp.test(t)},i.getProjectURL=function(e,t){return"https://api.github.com/repos/"+e+"/"+t+"/readme"},i});