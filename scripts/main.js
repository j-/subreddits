define(["require","ok.views","bootstrap","underscore","data/subreddits","collections/MultiredditCollection","views/NavigationView","controllers/StorageController","collections/Listing","models/CommentsModel","controllers/ListingController","controllers/CommentsController","modules/pagerouter","views/MainView","views/HeaderView"],function(e){e("ok.views"),e("bootstrap");var t=e("underscore"),n=e("data/subreddits"),r=e("collections/MultiredditCollection"),i=e("views/NavigationView"),s=e("controllers/StorageController"),o=new r,u=new i({watch:o});u.render(),u.start();var a=o.get();o.set(a);var f=new s({watch:o,storageKey:"subscriptions"});f.load(),$(window).on("beforeunload",function(){f.save()}),window.init=function(){o.set(n)},o.items.length||init();var l=e("collections/Listing"),c=e("models/CommentsModel"),h=e("controllers/ListingController"),p=e("controllers/CommentsController"),d=e("modules/pagerouter");d.start();var v=new l,m=new h({listing:v,router:d}),g=new c,y=new p({comments:g,router:d}),b=e("views/MainView"),w=new b({router:d,listing:v,listingController:m,comments:g,commentsController:y});w.render(),w.start();var E=e("views/HeaderView"),S=new E;S.render(),S.start(),S.on("refresh",function(){m.reload()}),S.on("expandall",function(){w.expandAll()}),S.on("collapseall",function(){w.collapseAll()}),S.on("search",function(e){m.search(e)}),$(function(){$(document.body).append(S.el).append(w.el).append(u.el)}),d.parseCurrent()});